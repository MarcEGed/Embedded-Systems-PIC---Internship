#include <18F46K22.h>
#fuses INTRC_IO, NOWDT, NOLVP, NOMCLR
#use delay(clock=16MHz)
#use rs232(baud=9600, xmit=PIN_C6, rcv=PIN_C7)
#use i2c(master, sda=PIN_C4, scl=PIN_C3, FAST)

void main() {
   int addr;

   delay_ms(500);
   printf("Scanning I2C Bus...\r\n");

   for (addr = 0; addr < 128; addr++) {
      i2c_start();
      int ack = i2c_write(addr << 1);
      i2c_stop();

      if (ack == 0) {
         printf("Found device at 0x%X\r\n", addr);
      }
   }

   printf("Done scanning.\r\n");

   while(TRUE);
}

