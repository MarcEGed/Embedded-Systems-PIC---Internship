#include <18F46K22.h>
#include "joystick.h"

#define VRX_PIN 2   //RA2
#define VRY_PIN 1   //RA1
#define SW_PIN  PIN_B0

void joystick_init(){
    setup_adc_ports(ALL_ANALOG);
    setup_adc(ADC_CLOCK_INTERNAL);

    port_b_pullups(TRUE);
    input(SW_PIN);
}

JoystickState joystick_read(){
    JoystickState state;

    set_adc_channel(VRX_PIN);
    delay_us(10);
    state.x = read_adc();

    set_adc_channel(VRY_PIN);
    delay_us(10);
    state.y = read_adc();

    state.sw = input(SW_PIN);

    return state;
}
